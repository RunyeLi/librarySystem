{
	"name": "check partition segment",
	"properties": {
		"content": {
			"query": "select count(*) from sys.dm_pdw_nodes_db_partition_stats nps --where nps.object_id = 2033442318\njoin sys.pdw_nodes_tables nt on nt.object_id = nps.object_id and nt.pdw_node_id = nps.pdw_node_id\n--join sys.pdw_permanent_table_mappings ptm on ptm.physical_name = nt.name\nwhere nps.object_id = 2033442318\n--where ptm.object_id = 755533775 and nps.object_id = 2033442318\norder by \n\n\n2033442318\n\njoin sys.tables t on nps.object_id = t.object_id\njoin sys.schemas s on t.schema_id = s.schema_id \n\nSELECT * FROM \nwhere t.name='Trip_12Partition' and s.name='test1110'\n\nselect OBJECT_NAME(2033442318)  (755533775)\nselect OBJECT_ID('test1110.Trip_2Partition')\n\nSELECT ROW_NUMBER()over(order by nps.partition_id) ,data_compression_desc, nps.partition_id,nps.object_id,nps.partition_number,nps.index_id,\n* FROM sys.pdw_nodes_partitions np --where np.object_id = 2033442318\njoin sys.dm_pdw_nodes_db_partition_stats nps on np.partition_id = nps.partition_id and nps.object_id = np.object_id and np.partition_number = nps.partition_number and nps.index_id = np.index_id\nwhere np.object_id = 2033442318 and \n\n\n\nSELECT count(*), nps.distribution_id,nps.partition_id FROM sys.dm_pdw_nodes_db_partition_stats nps where nps.object_id=2033442318 group by nps.distribution_id,nps.partition_id order by nps.partition_id\nWHERE object_id = OBJECT_ID('test1110.Trip_12Partition');  \n\nSELECT count(*) FROM sys.dm_pdw_nodes_db_partition_stats nps where nps.object_id=2033442318 --group by nps.partition_id order by nps.partition_id\n\n\nselect nt.name, nt.object_id, * from sys.pdw_nodes_tables nt\njoin sys.pdw_permanent_table_mappings ptm on ptm.physical_name = nt.name\nwhere ptm.object_id = 739533718\n\n\nselect nps.row_count, nps.used_page_count, nps.reserved_page_count, nps.pdw_node_id, nps.partition_number, nps.distribution_id,*\nfrom sys.dm_pdw_nodes_db_partition_stats nps\nwhere nps.object_id = (\n    select distinct nt.object_id\n    from sys.pdw_nodes_tables nt\n    join sys.pdw_permanent_table_mappings ptm on ptm.physical_name = nt.name\n    where ptm.object_id = OBJECT_ID('test1110.Trip_12Partition')\n)\n\nselect t.name, pnt.pdw_node_id, pnt.distribution_id, dpnbps.partition_number, dpnbps.row_count \nfrom sys.tables t\njoin sys.schemas s on t.schema_id = s.schema_id \njoin sys.pdw_permanent_table_mappings  pptm\non t.object_id = pptm.object_id\njoin sys.pdw_nodes_tables pnt\non pptm.physical_name = pnt.name\njoin sys.dm_pdw_nodes_db_partition_stats dpnbps\non pnt.object_id = dpnbps.object_id and pnt.distribution_id = dpnbps.distribution_id\nwhere t.name = 'Trip_12Partition' and s.name='test1110'\n\ncreate schema test1230\n\ncreate table test1230.Trip_12Partition with\n(\n\tDISTRIBUTION = ROUND_ROBIN,\n\tCLUSTERED COLUMNSTORE INDEX,\n\tPARTITION\n\t(\n\t\t[DateID] RANGE RIGHT FOR VALUES (20130201, 20130301, 20130401, 20130501, 20130601, 20130701, 20130801, 20130901, 20131001, 20131101, 20131201)\n\t)\n)\nas select * from test1110.Trip_12Partition\n\nselect distribution_id,* from sys.pdw_nodes_tables\n\n\n\nsys.dm_pdw_nodes_db_partition_stats nps where nps.object_id = 2033442318\njoin sys.pdw_nodes_tables nt on nt.object_id = nps.object_id\njoin sys.pdw_permanent_table_mappings ptm on ptm.physical_name = nt.name\nwhere ptm.object_id = 755533775 and nps.object_id = 2033442318\norder by \n\n\nselect * from sys.pdw_permanent_table_mappings\n\nselect * from sys.schemas\n\nselect * from dbo.vColumnstoreDensity where table_name='Trip_12Partition' and schema_name='test1110'",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "default",
				"poolName": "Built-in"
			},
			"resultLimit": -1
		},
		"type": "SqlQuery"
	}
}